import cli
from sqli_login_bypass import main as sqli_login_main
from sqli_second_order import main as sqli_second_order_main
from ssrf_lfi import main as ssrf_lfi_main
from ssrf_webhook import main as ssrf_webhook_main


def main(use_vulnerable_endpoint: bool, url_prefix: str) -> None:
    print("\n=== Running SQL Injection Login Bypass ===")
    sqli_login_main(use_vulnerable_endpoint, url_prefix)

    print("\n=== Running Second Order SQL Injection ===")
    sqli_second_order_main(use_vulnerable_endpoint, url_prefix)

    print("\n=== Running SSRF Webhook ===")
    ssrf_webhook_main(use_vulnerable_endpoint, url_prefix)

    print("\n=== Running SSRF Local File Inclusion ===")
    ssrf_lfi_main(use_vulnerable_endpoint, url_prefix)


if __name__ == "__main__":
    use_vulnerable_endpoint, url_prefix = cli.get_cli_arguments()
    main(use_vulnerable_endpoint, url_prefix)
