{% extends 'layout.html' %}
{% block content %}

<div class="bg-gray-100">
    <div class="px-8 py-12 max-w-5xl mx-auto space-y-4 text-gray-600">
        <h1 class="mt-6 text-2xl font-bold text-gray-900">
            What is SQL injection?
        </h1>
        <p>
            SQL injection is when an attacker can trick the server into
            running attacker-supplied SQL code against its database. For
            example, suppose you are an
            <a href="https://xkcd.com/327/" class="text-blue-400 hover:underline">elite hacker mom</a>. You name
            your son
            <span class="bg-gray-200 p-1 font-mono">Robert'); DROP TABLE Students;--
            </span>
            and send him off to school.
        </p>
        <p>
            If your son's school has a server that is vulnerable to SQL
            injection, then when they go to add your son as a student in
            the school's database this is the SQL query that is run:
        </p>
        <p class="bg-gray-200 p-1 font-mono w-max">
            <span class="text-black">INSERT INTO Students VALUES '</span>
            <span class="text-red-500">Robert</span>
            <span class="text-black">'); DROP TABLE Students;</span>
            <span class="text-green-500">-- ');</span>
        </p>
        <p class="text-black">Black text is SQL code</p>
        <p class="text-red-500">Red text is data from the user</p>
        <p class="text-green-500">Green text is a comment</p>
        <p>
            The intended result is for an insert statement to be
            executed. However, because the school is vulnerable to SQL
            injection, what actually happens is that the insert
            statement is executed, and then a drop statement is
            subsequently executed.
        </p>
        <p>
            In plain english: a student named Robert gets added to the
            list of students at the school, and then that list of
            students is subsequently deleted. This is how the student
            records are lost for the year. What would the SQL query look
            like if the school wasn't vulnerable to SQL injection?
        </p>
        <p class="bg-gray-200 p-1 font-mono w-max">
            <span class="text-black">INSERT INTO Students VALUES '</span>
            <span class="text-red-500">Robert'); DROP TABLE Students;--
            </span>
            <span class="text-black">');</span>
        </p>
        <div class="pt-4 space-y-4">
            <h1 class="mt-6 text-2xl font-bold text-gray-900">
                Heard about it in the news?
            </h1>
            <p>In early 2021, <a href="https://www.wired.com/story/gab-hack-data-breach-ddosecrets/"
                    class="text-blue-400 hover:underline">the social media platform Gab fell victim to a SQL
                    injection attack</a> that exposed users' private messages, posts, and passwords. SQL injection
                is probably the most well known web vulnerability out there. It has been in the spotlight since the
                early 2010s. Yet despite that, it still remains a potent threat even a decade later.</p>
        </div>
        <div class="pt-4 space-y-4">
            <h1 class="mt-6 text-2xl font-bold text-gray-900">
                Challenge
            </h1>
            <p>You know there is a user with the username <span
                    class="bg-gray-200 p-1 font-mono w-max">administrator</span>. Try to figure out how to login as
                <span class="bg-gray-200 p-1 font-mono w-max">administrator</span> without knowing what their
                password is!
            </p>

            <div class="w-full max-w-xs">
                <form method="POST" action="{{ url_for('vulnerabilities_sqli1.login') }}"
                    class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="username">
                            Username
                        </label>
                        <input
                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                            id="username" type="text" placeholder="Username">
                    </div>
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="password">
                            Password
                        </label>
                        <input
                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline"
                            id="password" type="password" placeholder="******************">
                    </div>
                    <div class="flex items-center justify-between">
                        <button
                            class="bg-gray-500 hover:bg-gray-400 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
                            type="submit">
                            Sign In
                        </button>
                    </div>
                </form>
            </div>
        </div>
        <div class="pt-4 space-y-4">
            <h1 class="mt-6 text-2xl font-bold text-gray-900">
                Code
            </h1>
            <p>View the <a href="https://github.com/neumaneuma/appseccheat.codes/blob/main/README.md"
                    class="text-blue-400 hover:underline">main README</a> to run the webapp locally</p>
            <p>View the <a href="https://github.com/neumaneuma/appseccheat.codes/blob/main/exploits/README.md"
                    class="text-blue-400 hover:underline">exploit README</a> to run the exploits locally</p>
        </div>
        <div class="pt-4">
            <h1 class="mt-6 text-2xl font-bold text-gray-900">
                Vulnerability
            </h1>
            <p class="mt-4 text-xs">File truncated for brevity. <a
                    href="https://github.com/neumaneuma/appseccheat.codes/blob/main/webapp/webapp/vulnerabilities/sqli_login_bypass.py"
                    class="text-blue-400 hover:underline">Click here</a> to view full file.
            </p>
            <script src="https://gist.github.com/neumaneuma/39a853dfe14e7084ecc8ac8b304c60a3.js"></script>
        </div>
        <div class="pt-4">
            <h1 class="mt-6 text-2xl font-bold text-gray-900">
                Exploit
            </h1>
            <p class="mt-4 text-xs">File truncated for brevity. <a
                    href="https://github.com/neumaneuma/appseccheat.codes/blob/main/exploits/sqli_login_bypass.py"
                    class="text-blue-400 hover:underline">Click here</a> to view full file.
            </p>
            <script src="https://gist.github.com/neumaneuma/2cd5ffda86a9f3beee7858fd3ee21b10.js"></script>
        </div>
        <div class="pt-4">
            <h1 class="mt-6 text-2xl font-bold text-gray-900">
                Patch
            </h1>
            <p class="mt-4 text-xs">File truncated for brevity. <a
                    href="https://github.com/neumaneuma/appseccheat.codes/blob/main/webapp/webapp/patches/sqli_login_bypass.py"
                    class="text-blue-400 hover:underline">Click here</a> to view full file.
            </p>
            <script src="https://gist.github.com/neumaneuma/0076b3c6735f6002c680415483566e6e.js"></script>
        </div>
        <div class="pt-4 space-y-4">
            <h1 class="mt-6 text-2xl font-bold text-gray-900">
                Explanation
            </h1>
            <p>
                This defense makes use of what is known as a <a
                    href="https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html#parameterized-query-examples"
                    class="text-blue-400 hover:underline">parameterized query</a>. A succinct way of explaining it
                is that a parameterized query interprets user input as data instead of code.</p>
            <p>Another technique that can supplement a parameterized query is to implement an allow-list. An
                allow-list specifies what characters are allowed as input, and rejects everything else. However, for
                most situations involving SQL injection, it is impractical to implement an allow-list because all
                characters are valid. For example, restricting what characters a user can enter for a password is
                considered a poor user experience. Therefore a parameterized query is the primary line of defense.
            </p>
        </div>
        <div class="grid grid-cols-2 pt-48">
            <div class="flex justify-start">
                <a class="inline-block px-5 py-3 rounded bg-gray-500 hover:bg-gray-400 uppercase font-bold text-sm text-white shadow-lg sm:text-base"
                    href="#">Previous Challenge
                </a>
            </div>
            <div class="flex justify-end">
                <a class="inline-block px-5 py-3 rounded bg-gray-500 hover:bg-gray-400 uppercase font-bold text-sm text-white shadow-lg sm:text-base"
                    href="#">Next Challenge
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}